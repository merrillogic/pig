<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Carleton Honeynet Project</title>
        <meta name="description" content="">
        <meta name="author" content="">

        <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <!-- Le styles -->
        <link href="{{ STATIC_URL }}twitter-bootstrap/docs/assets/css/bootstrap.css" rel="stylesheet">
        <style>
            body {
                padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
            }
            table#attackInfo {
            }
            #attackInfo td {
                padding: 8px;
            }
            
            <!--overwrite bootstrap form formating-->
            form {
            }
            
            .well#payload{
                background-color:#FFFFFF;
            }
            
            table#packetTable {
            }
            #packetTable th {
                background-color: #ffffff;
                cursor: default;
            }
            #packetTable td:hover {
                cursor: pointer;
            }
            #packetTable tr:hover {
                background-color: #c0c0c0;
            }
        </style>
        <link href="{{ STATIC_URL }}twitter-bootstrap/docs/assets/css/bootstrap-responsive.css" rel="stylesheet">

        <!-- Le fav and touch icons -->
        <link rel="shortcut icon" href="images/favicon.ico">
        <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
        <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    </head>

    <body>
        <div class="navbar navbar-fixed-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="#">Carleton Honeynet Project</a>
                    <div class="nav-collapse">
                        <!--
                        <ul class="nav">
                            <li class="active"><a href="#">Home</a></li>
                            <li><a href="#about">About</a></li>
                            <li><a href="#contact">Contact</a></li>
                        </ul>
                        -->
                    </div><!--/.nav-collapse -->
                </div>
            </div>
        </div>

        <div class = "container">
            <div class = "row">
                <div class = "span4">
                    <div class = "well">
                        <!--Attack Details-->
                        <table class = "table-condensed" id = "attackInfo">
                            <thead>
                                <tr>
                                    <th>Attack Information</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Type:</td>
                                    <td>{{ attack.attack_type }}</td>
                                </tr>
                                <tr>
                                    <td>Start Time:</td>
                                    <td>{{ attack.start_time }}</td>
                                </tr>
                                <tr>
                                    <td>End Time:</td>
                                    <td>{{ attack.end_time }}</td>
                                </tr>
                                <tr>
                                    <td>Source IP:</td>
                                    <td>{{ attack.source_ip }}</td>
                                </tr>
                                <tr>
                                    <td>Dest IP:</td>
                                    <td>{{ attack.destination_ip }}</td>
                                </tr>
                                <tr>
                                    <td>Threat Level:</td>
                                    <td>{{ attack.score }}</td>
                                </tr>
                                <tr>
                                    <td></td>
                                    <td>
                                        <input id = "falsePositive" type = "checkbox" /> False Positive
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        
                    </div>
                </div>

                <div class = "span8">
                    <div class = "well" id = "payload">
                        <!-- Payload of selected packet -->
                        <h4>Packet Payload</h4>
                        <p id = "payloadInfo">no packet selected</p>
                    </div>
                </div>
            </div>

            <div class = "row">
                <div class = "span12">
                     <table class = "table" id = "packetTable">
                        <thead>
                            <tr>
                                <th>id</th>
                                <th>time</th>
                                <th>src ip</th>
                                <th>src mac</th>
                                <th>src port</th>
                                <th>dest ip</th>
                                <th>dest mac</th>
                                <th>dest port</th>
                                <th>protocol</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if packet_list %}
                                {% for packet in packet_list %}
                                    <tr>
                                        <td id = "idCol">{{ packet.packet_id }}</td>
                                        <td id = "timeCol">{{ packet.time }}</td>
                                        <td id = "srcIpCol">{{ packet.source_ip }}</td>
                                        <td id = "srcMacCol">{{ packet.source_mac }}</td>
                                        <td id = "srcPortCol">{{ packet.source_port }}</td>
                                        <td id = "destIpCol">{{ packet.destination_ip }}</td>
                                        <td id = "destMacCol">{{ packet.destination_mac }}</td>
                                        <td id = "destPortCol">{{ packet.destination_port }}</td>
                                        <td id = "protocolCol">{{ packet.protocol }}</td>
                                    </tr>
                                {% endfor %}
                            {% else %}
                                <tr>
                                    <td>No packets found</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
            </div>
        </div>

        <!-- Le javascript
        ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->
        <script src="{{ STATIC_URL }}twitter-bootstrap/docs/assets/js/jquery.js"></script>
        <script src="{{ STATIC_URL }}twitter-bootstrap/docs/assets/js/bootstrap-transition.js"></script>
        <script src="{{ STATIC_URL }}twitter-bootstrap/docs/assets/js/bootstrap-alert.js"></script>
        <script src="{{ STATIC_URL }}twitter-bootstrap/docs/assets/js/bootstrap-modal.js"></script>
        <script src="{{ STATIC_URL }}twitter-bootstrap/docs/assets/js/bootstrap-dropdown.js"></script>
        <script src="{{ STATIC_URL }}twitter-bootstrap/docs/assets/js/bootstrap-scrollspy.js"></script>
        <script src="{{ STATIC_URL }}twitter-bootstrap/docs/assets/js/bootstrap-tab.js"></script>
        <script src="{{ STATIC_URL }}twitter-bootstrap/docs/assets/js/bootstrap-tooltip.js"></script>
        <script src="{{ STATIC_URL }}twitter-bootstrap/docs/assets/js/bootstrap-popover.js"></script>
        <script src="{{ STATIC_URL }}twitter-bootstrap/docs/assets/js/bootstrap-button.js"></script>
        <script src="{{ STATIC_URL }}twitter-bootstrap/docs/assets/js/bootstrap-collapse.js"></script>
        <script src="{{ STATIC_URL }}twitter-bootstrap/docs/assets/js/bootstrap-carousel.js"></script>
        <script src="{{ STATIC_URL }}twitter-bootstrap/docs/assets/js/bootstrap-typeahead.js"></script>
        
        <script type="text/javascript">
            //Function that handles clicking of rows on attack table
            $(document).ready(function() {
                $('#packetTable td').click(function(event) {
                    var pid = $(this).parent().children('#idCol').text();
                    
                    {% for packet in packet_list %}
                        if(pid == {{ packet.id }}){
                            $('#payloadInfo').text('{{ packet.payload }}');
                        }
                    {% endfor %}
                });
            });
        </script>
    </body>
</html>

